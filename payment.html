<!DOCTYPE html>
<html ⚡ lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1" />
    <title>Paiement Sécurisé - Abidjan Solution</title>
    <link rel="canonical" href="https://www.abidjansolution.biz/payment" />
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
    <script async custom-element="amp-bind" src="https://cdn.ampproject.org/v0/amp-bind-0.1.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

    <style amp-custom>
        :root { --main-green: #008060; --accent-orange: #f58220; --text-color: #333; }
        body { font-family: 'Roboto', sans-serif; margin: 0; background: #f1f3f6; font-size: 16px; }
        .container { max-width: 800px; margin: 0 auto; padding: 25px 15px; }

        header { background: white; padding: 15px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .checkout-card { background: white; padding: 35px; border-radius: 12px; border: 1px solid #eee; margin-top: 25px; }
        
        .auth-lock { background: #fff8f0; border: 2px dashed var(--accent-orange); padding: 25px; border-radius: 10px; text-align: center; margin-bottom: 30px; }
        .btn-auth { background: var(--main-green); color: white; border: none; padding: 15px 30px; border-radius: 30px; font-weight: bold; cursor: pointer; font-size: 16px; }
        
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 15px; }
        input { width: 100%; padding: 14px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 17px; }
        
        .submit-btn { background: var(--main-green); color: white; border: none; padding: 18px; width: 100%; border-radius: 8px; font-weight: 900; cursor: pointer; opacity: 0.5; pointer-events: none; font-size: 18px; }
        .submit-btn.is-active { opacity: 1; pointer-events: auto; background: var(--accent-orange); box-shadow: 0 4px 10px rgba(245, 130, 32, 0.3); }
        
        .order-summary { background: #f8fafc; padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 6px solid var(--main-green); }
        h2 { font-size: 26px; font-weight: 800; margin-top: 0; }
    </style>
</head>
<body on="message:AMP.setState({authState: event.data.user})">
    <amp-state id="authState"><script type="application/json">null</script></amp-state>
    <amp-iframe id="auth-handler" layout="nodisplay" sandbox="allow-scripts allow-same-origin allow-forms allow-popups" src="/auth-handler.html"></amp-iframe>

    <header>
        <div class="container" style="display:flex; justify-content:space-between; align-items:center">
            <a href="index.html"><amp-img src="https://firebasestorage.googleapis.com/v0/b/abidjansolution0006.appspot.com/o/abidjansolution_logo1.webp?alt=media&token=70c8f779-d817-46a3-b399-d7c12e3b8fcc" width="140" height="44" layout="fixed"></amp-img></a>
            <span style="font-size:15px; font-weight:900; color:var(--main-green)">PAIEMENT SÉCURISÉ</span>
        </div>
    </header>

    <main class="container">
        <div class="checkout-card">
            <h2>Finaliser ma commande</h2>
            
            <div class="order-summary">
                <p style="margin:0; font-size:16px">Article sélectionné : <strong [text]="QUERY_PARAM('name') || 'Solution Abidjan'">Chargement...</strong></p>
                <p style="margin:8px 0 0; font-size:22px; color:var(--accent-orange); font-weight:900" [text]="(QUERY_PARAM('price') || '...') + ' F'"></p>
            </div>

            <div class="auth-lock" [hidden]="authState">
                <p style="font-size:15px; margin-bottom:20px; font-weight:bold">Pour valider votre commande, veuillez vous identifier.</p>
                <button class="btn-auth" on="tap:auth-handler.postMessage({command: 'signInWithGoogle'})">S'IDENTIFIER AVEC GOOGLE</button>
            </div>

            <div [hidden]="!authState" hidden style="background:#e7f3f0; padding:18px; border-radius:10px; margin-bottom:25px; font-size:16px; border: 1px solid var(--main-green)">
                ✅ Client identifié : <strong [text]="authState.displayName">...</strong>
            </div>

            <form method="post" action-xhr="/api/saveLeadAndNotify" target="_top">
                <input type="hidden" name="product" [value]="QUERY_PARAM('name')">
                <input type="hidden" name="price" [value]="QUERY_PARAM('price')">
                <input type="hidden" name="user_email" [value]="authState ? authState.email : ''">

                <div class="form-group">
                    <label>Contact Téléphonique (WhatsApp ou Appel)</label>
                    <input type="tel" name="contact" placeholder="Ex: 07 07 28 34 05" required>
                </div>
                <div class="form-group">
                    <label>Lieu de Livraison Exact</label>
                    <input type="text" name="location" placeholder="Ex: Riviera Palmeraie, Immeuble..." required>
                </div>

                <button type="submit" class="submit-btn" [class]="authState ? 'submit-btn is-active' : 'submit-btn'">
                    CONFIRMER MA COMMANDE
                </button>
                
                <div submit-success><template type="amp-mustache"><p style="color:green; font-weight:bold; margin-top:20px; font-size:18px">Félicitations ! Un agent vous contactera sous peu.</p></template></div>
            </form>
        </div>
    </main>
</body>
</html>